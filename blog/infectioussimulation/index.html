<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous  /> <link rel=stylesheet  href="/css/franklin.css"> <link rel=icon  href="/assets/favicon.ico"> <title>Simulating the Spread of Infectious Disease in 200 lines of C</title> <header> <a class=title  href="/"><h2>0x0f0f0f - Alessandro Cheli</h2></a> <nav> <a href="/">Home</a> / <a href="/blog">Blog</a> / <a href="/tag/">Tags</a> <div class=social-media > <a style="color: #000000;" href="https://github.com/0x0f0f0f"><i class="fab fa-github"></i></a> <a style="color: #000000;" href="https://twitter.com/0x0f0f0f1"><i class="fab fa-twitter"></i></a> </div> </nav> </header> <main> <div class=container ><h1>Simulating the Spread of Infectious Disease in 200 lines of C</h1> <p>Published 18 March 2020</p> <p><b>Tags: </b><a href="/tag/covid">#covid</a>, <a href="/tag/infection">#infection</a>, <a href="/tag/c">#c</a>, <a href="/tag/simulation">#simulation</a></p><hr/> <p>Greetings from Italy. I am currently quarantined in my apartment. For me and many other people this lockdown can often get motivationally debilitating when it comes to working to personal, academic or work projects. The lockdown measures taken by governments to fight off the pandemic are necessary to reduce the damage that the disease caused by the SARS-COV-2 &quot;coronavirus&quot; is doing to the global society. Inspired by a recent popular news article about the effectivity of containment measures during outbreaks, I wrote this small animation/simulation in a single C file &#40;using <a href="https://raylib.com">raylib</a>, you need it to build this project&#41; to show what happens if you avoid moving and social contact during an epidemic. You can find the code in this <a href="https://github.com/0x0f0f0f/infectious-disease-toy-simulation">GitHub repository</a>. All the parameters are easily adjustable and hardcoded. Yes, you need to recompile if you change them.</p> <p>Keep in mind that <strong>this is not a precise simulation</strong> and it is quite buggy. For the sake of simplicity, the bouncing balls do not even remotely resemble a realistic physical simulation of colliding particles in a box, but instead have randomized drifting of their trajectory. This is a toy animation made to show that distancing/quarantine measures during outbreaks are good countermeasures and delay the rapid spread of infectious disease. Spheres in a box that are moving &#40;or not moving&#41; around are simple enough to show the difference between situations where a percentage of the population is not moving from their houses during an epidemic. In reality, a precise mathematical model of a pandemic response has probably dozens more parameters. For example, in this unprecise simulation, there is a global variable representing the chance - between 0 and 1</p> <ul> <li><p>of an infected individual infecting another susceptible individual upon</p> </ul> <p>contact. In real mathematical modeling of disease there&#39;s a number called <em>Basic reproduction number</em> or R0, which represents <em>&quot;the expected number of cases directly generated by one case in a population where all individuals are susceptible to infection&quot;</em>. You can read more about the SARS-COV-2 R0 in this paper: <a href="https://www.medrxiv.org/content/10.1101/2020.01.27.20018952v1">Estimating the effective reproduction number of the 2019-nCoV in China</a>. In a precise simulation one should also keep track of the average geographical location and movements, age, social context and health condition. This requires a lot of additional data that does not fit in 200 lines of C code.</p> <h2 id=enough_smalltalk_show_the_data ><a href="#enough_smalltalk_show_the_data" class=header-anchor >Enough Smalltalk, Show the Data&#33;</a></h2> <p>Color legend:</p> <ul> <li><p>Gray - Has never come in contact with the disease and is susceptible</p> <li><p>Purple - Is infected</p> <li><p>Green - Has recovered and is immune to the disease.</p> <li><p>Red - Has died</p> </ul> <p>The graph shows a sample &#40;taken every 5 frames by default&#41; of the size of these partitions of the total population over time. Default simulation time is 40 seconds and is easily tweakable. Other easily adjustable values are window width and height, probability of dying if infected, probability of infecting another individual upon contact, the time needed to heal or die, the population size, the fraction of people that are moving and the graph sampling rate.</p> <p>You can easily see that the less people are moving, the slower it takes to the disease to reach the whole population. In contrast, if everybody ignores the quarantining measures, such as in the fourth screenshot of the simulation, you can see that the disease spreads extremely fast.</p> <h2 id=14_of_the_population_is_moving ><a href="#14_of_the_population_is_moving" class=header-anchor >1/4 of the population is moving</a></h2> <p><img src="https://raw.githubusercontent.com/0x0f0f0f/infectious-disease-toy-simulation/684ad3b670158dcc3ff48ee3574b2e8a28e37f4b/screenshots/4.png" alt="1/4 of the population is moving" /></p> <h2 id=13_of_the_population_is_moving ><a href="#13_of_the_population_is_moving" class=header-anchor >1/3 of the population is moving</a></h2> <p><img src="https://raw.githubusercontent.com/0x0f0f0f/infectious-disease-toy-simulation/684ad3b670158dcc3ff48ee3574b2e8a28e37f4b/screenshots/3.png" alt="1/3 of the population is moving" /></p> <h2 id=12_of_the_population_is_moving ><a href="#12_of_the_population_is_moving" class=header-anchor >1/2 of the population is moving</a></h2> <p><img src="https://raw.githubusercontent.com/0x0f0f0f/infectious-disease-toy-simulation/684ad3b670158dcc3ff48ee3574b2e8a28e37f4b/screenshots/2.png" alt="1/2 of the population is moving" /></p> <h2 id=11_of_the_population_is_moving ><a href="#11_of_the_population_is_moving" class=header-anchor >1/1 of the population is moving</a></h2> <p><img src="https://raw.githubusercontent.com/0x0f0f0f/infectious-disease-toy-simulation/684ad3b670158dcc3ff48ee3574b2e8a28e37f4b/screenshots/1.png" alt="1/1 of the population is moving" /></p> <h2 id=bibliography ><a href="#bibliography" class=header-anchor >Bibliography</a></h2> <ul> <li><p><a href="https://www.medrxiv.org/content/10.1101/2020.01.27.20018952v1">Estimating the effective reproduction number of the 2019-nCoV in China</a> - Zhidong Cao, Qingpeng Zhang, Xin Lu, Dirk Pfeiffer, Zhongwei Jia, Hongbing Song, Daniel Dajun Zeng - January 2020</p> </ul> </div> </main> </div> <footer> &copy; Alessandro Cheli. Made with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and <a href="https://julialang.org">The Julia Programming Language</a>. </footer>